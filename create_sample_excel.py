"""
ุงุณฺฉุฑูพุช ุงุฌุงุฏ ูุงู ููููู ุงฺฉุณู
"""
import pandas as pd
from datetime import datetime, timedelta
import random

# ุงุฌุงุฏ ุฏุงุฏูโูุง ููููู
num_records = 1000

data = {
    'Id': range(1, num_records + 1),
    'ุชุงุฑุฎ': [],
    'ุดูุงุฑู ุณูุฏ': [],
    'ฺฉุฏ ุญุณุงุจ': [],
    'ุจุฏูฺฉุงุฑ': [],
    'ุจุณุชุงูฺฉุงุฑ': [],
    'ุดุฑุญ': []
}

# ูุณุช ฺฉุฏูุง ุญุณุงุจ ููููู
account_codes = [
    '1101', '1102', '1103', '2101', '2102', '3101', '3102',
    '4101', '4102', '5101', '5102', '6101', '6102'
]

# ูุณุช ุดุฑุญ ููููู
descriptions = [
    'ุฎุฑุฏ ฺฉุงูุง',
    'ูุฑูุด ฺฉุงูุง',
    'ุฏุฑุงูุช ุงุฒ ูุดุชุฑ',
    'ูพุฑุฏุงุฎุช ุจู ุชุงููโฺฉููุฏู',
    'ุญููู ฺฉุงุฑฺฉูุงู',
    'ูุฒูู ุงุฏุงุฑ',
    'ูุฒูู ุญูู ู ููู',
    'ุณูพุฑุฏู ุจุงูฺฉ',
    'ุจุฑุฏุงุดุช ุงุฒ ุจุงูฺฉ',
    'ุงุณุชููุงฺฉ',
    'ุชุนูุฑุงุช',
    'ุชุจูุบุงุช'
]

# ุชููุฏ ุฏุงุฏูโูุง ุชุตุงุฏู
start_date = datetime(2024, 1, 1)

for i in range(num_records):
    # ุชุงุฑุฎ
    random_days = random.randint(0, 365)
    date = start_date + timedelta(days=random_days)
    data['ุชุงุฑุฎ'].append(date.strftime('%Y-%m-%d'))
    
    # ุดูุงุฑู ุณูุฏ
    data['ุดูุงุฑู ุณูุฏ'].append(1000 + i)
    
    # ฺฉุฏ ุญุณุงุจ
    data['ฺฉุฏ ุญุณุงุจ'].append(random.choice(account_codes))
    
    # ูุจูุบ - ุชููุฏ ุงุนุฏุงุฏ ุทุจู ูุงููู ุจูููุฑุฏ
    if random.random() < 0.7:  # 70% ุงุนุฏุงุฏ ุทุจุน
        first_digit = random.choices(
            [1, 2, 3, 4, 5, 6, 7, 8, 9],
            weights=[30.1, 17.6, 12.5, 9.7, 7.9, 6.7, 5.8, 5.1, 4.6]
        )[0]
        amount = first_digit * (10 ** random.randint(3, 6)) + random.randint(0, 999999)
    else:  # 30% ุงุนุฏุงุฏ ฺฏุฑุฏ ู ูุดฺฉูฺฉ
        amount = random.choice([1000, 5000, 10000, 50000, 100000, 500000])
    
    # ุชุตููโฺฏุฑ ุจุฏูฺฉุงุฑ ุง ุจุณุชุงูฺฉุงุฑ
    if random.random() < 0.5:
        data['ุจุฏูฺฉุงุฑ'].append(amount)
        data['ุจุณุชุงูฺฉุงุฑ'].append(0)
    else:
        data['ุจุฏูฺฉุงุฑ'].append(0)
        data['ุจุณุชุงูฺฉุงุฑ'].append(amount)
    
    # ุดุฑุญ
    data['ุดุฑุญ'].append(random.choice(descriptions))

# ุงูุฒูุฏู ฺูุฏ ุฑฺฉูุฑุฏ ูุดฺฉูฺฉ ุจุฑุง ุชุณุช
# ุฑฺฉูุฑุฏูุง ุชฺฉุฑุงุฑ
for i in range(5):
    idx = random.randint(0, num_records - 1)
    data['Id'].append(num_records + i + 1)
    data['ุชุงุฑุฎ'].append(data['ุชุงุฑุฎ'][idx])
    data['ุดูุงุฑู ุณูุฏ'].append(data['ุดูุงุฑู ุณูุฏ'][idx])
    data['ฺฉุฏ ุญุณุงุจ'].append(data['ฺฉุฏ ุญุณุงุจ'][idx])
    data['ุจุฏูฺฉุงุฑ'].append(data['ุจุฏูฺฉุงุฑ'][idx])
    data['ุจุณุชุงูฺฉุงุฑ'].append(data['ุจุณุชุงูฺฉุงุฑ'][idx])
    data['ุดุฑุญ'].append(data['ุดุฑุญ'][idx])

# ุงุฌุงุฏ DataFrame
df = pd.DataFrame(data)

# ุฐุฎุฑู ุจู ุงฺฉุณู
output_file = 'sample_transactions.xlsx'
df.to_excel(output_file, index=False)

print(f'โ ูุงู ููููู {output_file} ุจุง {len(df)} ุฑฺฉูุฑุฏ ุงุฌุงุฏ ุดุฏ')
print(f'๐ ุงู ูุงู ุดุงูู:')
print(f'   - ุฏุงุฏูโูุง ูุทุงุจู ุจุง ูุงููู ุจูููุฑุฏ')
print(f'   - ุงุนุฏุงุฏ ฺฏุฑุฏ ูุดฺฉูฺฉ')
print(f'   - ุฑฺฉูุฑุฏูุง ุชฺฉุฑุงุฑ ุจุฑุง ุชุณุช')
print(f'   - ูุจุงูุบ ูุฌูู')
print(f'\n๐ ุงู ูุงู ุฑุง ุฏุฑ ุฑุงุจุท ฺฉุงุฑุจุฑ ูุจ ุขูพููุฏ ฺฉูุฏ')
