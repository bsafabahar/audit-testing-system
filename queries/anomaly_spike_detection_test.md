# مستندات آزمون تشخیص رشد ناگهانی

## نام آزمون
**آزمون شناسایی رشد و افت ناگهانی** (Spike Detection Test)

## هدف و کاربرد در حسابرسی

### چرا از این آزمون استفاده می‌کنیم؟
تغییرات ناگهانی و غیرعادی در مقادیر مالی می‌توانند نشانه‌ای از:
- **تقلب در گزارش‌گیری:** دستکاری عمدی در ارقام برای نشان دادن عملکرد بهتر یا بدتر
- **خطاهای حسابداری:** اشتباهات بزرگ در ثبت
- **تراکنش‌های غیرعادی:** فعالیت‌های خارج از روال معمول
- **دستکاری در درآمدها:** افزایش مصنوعی فروش یا کاهش هزینه‌ها

**در حسابرسی از این آزمون برای:**
- **شناسایی تغییرات غیرعادی:** کشف افزایش یا کاهش‌های ناگهانی
- **تایید روند طبیعی:** اطمینان از عدم دستکاری در ارقام
- **تحلیل عملکرد:** بررسی دلایل تغییرات بزرگ
- **کشف تقلب:** شناسایی الگوهای مشکوک

### کاربردهای عملی:
- تحلیل روند فروش ماهانه
- بررسی تغییرات هزینه‌ها
- کنترل نوسانات درآمد
- شناسایی دوره‌های غیرعادی

## پارامترهای ورودی

### 1. آستانه رشد ناگهانی (spikeThreshold)
- **نوع:** عدد (درصد)
- **مقدار پیش‌فرض:** 200%
- **توضیح:** حداقل درصد تغییر نسبت به دوره قبل برای شناسایی به عنوان رشد یا افت ناگهانی
- **مفهوم:**
  - 100%: دو برابر شدن یا نصف شدن
  - 200%: سه برابر شدن یا کاهش 67%
  - 300%: چهار برابر شدن
- **توصیه:**
  - کسب‌وکارهای پایدار: 150-200%
  - کسب‌وکارهای نوپا: 300-400%
  - شرکت‌های بزرگ: 100-150%

## ستون‌های خروجی

### 1. Period (دوره)
- دوره زمانی که رشد یا افت ناگهانی دارد
- فرمت: YYYY-MM (مثلاً 2024-03)

### 2. Amount (مبلغ)
- کل مبلغ تراکنش‌های این دوره

### 3. PreviousPeriod (دوره قبل)
- دوره قبلی برای مقایسه

### 4. PreviousAmount (مبلغ قبل)
- کل مبلغ تراکنش‌های دوره قبل

### 5. Change (تغییر)
- تفاضل مبلغ فعلی از مبلغ قبل
- مثبت: افزایش، منفی: کاهش

### 6. ChangePercent (درصد تغییر)
- درصد تغییر نسبت به دوره قبل
- محاسبه: ((مبلغ فعلی - مبلغ قبل) / مبلغ قبل) × 100

### 7. AvgAmount (میانگین)
- میانگین مبلغ تمام دوره‌ها
- برای مقایسه با میانگین کلی

### 8. SpikeType (نوع رشد)
- نوع تغییر:
  - `رشد ناگهانی`: افزایش بیش از آستانه
  - `افت ناگهانی`: کاهش بیش از آستانه

## نحوه انجام آزمون

### مراحل اجرا:

1. **دریافت داده‌ها:**
   - تمام تراکنش‌ها از پایگاه داده خوانده می‌شوند

2. **گروه‌بندی بر اساس دوره:**
   - هر تراکنش به دوره ماهانه (YYYY-MM) تخصیص داده می‌شود
   - مبالغ (بدهکار یا بستانکار) برای هر دوره جمع می‌شوند

3. **مرتب‌سازی زمانی:**
   - دوره‌ها از قدیم به جدید مرتب می‌شوند

4. **محاسبه میانگین کلی:**
   - میانگین مبلغ تمام دوره‌ها محاسبه می‌شود

5. **مقایسه دوره‌های متوالی:**
   - برای هر دوره (از دومین دوره به بعد):
     ```
     تغییر = مبلغ فعلی - مبلغ قبل
     درصد تغییر = (تغییر / مبلغ قبل) × 100
     ```

6. **شناسایی رشد/افت ناگهانی:**
   ```
   اگر |درصد تغییر| ≥ آستانه:
       اگر درصد تغییر > 0:
           نوع = "رشد ناگهانی"
       اگر درصد تغییر < 0:
           نوع = "افت ناگهانی"
   ```

7. **مرتب‌سازی:**
   - نتایج بر اساس قدر مطلق درصد تغییر (بالا به پایین) مرتب می‌شوند

## تفسیر نتایج

### سطوح درصد تغییر:

#### 200-400% - قابل توجه
- **رشد:**
  - 3-5 برابر شدن
  - احتمال: رشد طبیعی کسب‌وکار، کمپین بازاریابی
- **افت:**
  - کاهش 67-80%
  - احتمال: کاهش فصلی، کاهش فروش
- **سطح ریسک:** متوسط
- **اقدام:** بررسی و مستندسازی دلیل

#### 400-800% - مشکوک
- **رشد:**
  - 5-9 برابر شدن
  - احتمال: تراکنش بزرگ غیرعادی، خطای ثبت
- **افت:**
  - کاهش بیش از 80%
  - احتمال: توقف عملیات، مشکل جدی
- **سطح ریسک:** بالا
- **اقدام:** تحقیق دقیق

#### 800%+ - بسیار مشکوک
- **رشد:**
  - 9+ برابر شدن
  - احتمال: دستکاری، خطای بزرگ، تقلب
- **افت:**
  - کاهش بیش از 90%
  - احتمال: حذف تراکنش‌ها، بحران
- **سطح ریسک:** بسیار بالا
- **اقدام:** تحقیق فوری

### علائم خطر (Red Flags):

1. **رشد ناگهانی در پایان دوره مالی:**
   - افزایش بزرگ در ماه آخر سال
   - احتمال دستکاری برای رسیدن به اهداف

2. **افت ناگهانی بعد از رشد:**
   - الگوی صعود و سقوط سریع
   - احتمال تراکنش‌های جعلی

3. **رشد غیرمنطقی نسبت به میانگین:**
   - مبلغ دوره بسیار بیشتر از میانگین کلی
   - نیاز به توضیح

4. **الگوی تکراری رشد/افت:**
   - چند دوره متوالی با نوسانات بزرگ
   - احتمال دستکاری سیستماتیک

## مثال عملی

### سناریو:
تحلیل فروش ماهانه یک شرکت تولیدی

### تنظیمات:
- spikeThreshold: 200%

### نتیجه نمونه:
```
دوره    | مبلغ         | دوره قبل | مبلغ قبل    | تغییر       | درصد     | میانگین      | نوع
2024-03  | 900,000,000  | 2024-02  | 150,000,000 | +750,000,000| +500%    | 300,000,000  | رشد ناگهانی
2024-06  | 50,000,000   | 2024-05  | 350,000,000 | -300,000,000| -85.7%   | 300,000,000  | افت ناگهانی
2024-09  | 800,000,000  | 2024-08  | 200,000,000 | +600,000,000| +300%    | 300,000,000  | رشد ناگهانی
```

### تحلیل:

1. **مارس 2024 (رشد 500%) - بسیار مشکوک:**
   - فروش از 150M به 900M (6 برابر)
   - بسیار بالاتر از میانگین (300M)
   - **تحقیق فوری:**
     - چه تراکنش‌هایی باعث این افزایش شده؟
     - آیا فاکتورهای بزرگ معتبر هستند؟
     - آیا مشتری واقعی است؟
     - آیا کالا تحویل شده؟

2. **ژوئن 2024 (افت 85.7%) - بسیار مشکوک:**
   - فروش از 350M به 50M (کاهش شدید)
   - بسیار کمتر از میانگین
   - **بررسی:**
     - چرا فروش این‌قدر کاهش یافته؟
     - آیا مشکلی در تولید بوده؟
     - آیا تراکنش‌ها حذف شده‌اند؟

3. **سپتامبر 2024 (رشد 300%) - مشکوک:**
   - فروش از 200M به 800M (4 برابر)
   - **بررسی:**
     - دلیل افزایش چیست؟
     - آیا فصلی است؟
     - آیا قرارداد بزرگی منعقد شده؟

### اقدامات تحقیقاتی:

**برای مارس 2024:**
1. لیست تمام فاکتورهای مارس
2. بررسی 10 فاکتور بزرگ‌تر
3. تایید مشتریان
4. بررسی تحویل کالا/خدمات
5. مطابقت با صورت‌های بانکی

## نکات مهم

### محدودیت‌ها:
- ❌ رشدهای طبیعی در کسب‌وکارهای نوپا را هم نشان می‌دهد
- ❌ در صنایع فصلی ممکن است false positive زیاد باشد
- ❌ نمی‌تواند علت تغییر را مشخص کند

### بهترین کاربردها:
- ✅ کسب‌وکارهای با فروش نسبتاً ثابت
- ✅ تحلیل روندهای ماهانه
- ✅ شناسایی دوره‌های غیرعادی
- ✅ کنترل دستکاری در گزارش‌ها

### توصیه‌ها:
1. **تنظیم آستانه بر اساس صنعت:**
   - صنایع پایدار: آستانه پایین‌تر
   - صنایع نوسانی: آستانه بالاتر

2. **بررسی زمینه:**
   - تغییرات را با رویدادهای کسب‌وکار مطابقت دهید
   - تعطیلات، کمپین‌ها، فصل‌ها را در نظر بگیرید

3. **ترکیب با آزمون‌های دیگر:**
   - آزمون تراکنش‌های بزرگ
   - آزمون مشتریان/فروشندگان جدید

4. **تحلیل روند کلی:**
   - نگاه به چند ماه قبل و بعد
   - الگوهای فصلی را شناسایی کنید

### اقدامات پیشگیرانه:
- تعیین اهداف واقع‌بینانه فروش
- پایش مستمر روندها
- گزارش‌گیری ماهانه
- تایید تراکنش‌های بزرگ

## ارتباط با سایر آزمون‌ها

- **آزمون تحلیل فاصله‌ها:** رشد بعد از فاصله طولانی مشکوک است
- **آزمون پارتو:** دوره‌های با رشد ناگهانی ممکن است ناشی از چند مشتری بزرگ باشد
- **آزمون تخفیفات غیرعادی:** افت ناگهانی ممکن است ناشی از تخفیفات زیاد باشد
- **آزمون فصلی:** برای تشخیص تغییرات طبیعی فصلی

## محاسبات نمونه

### مثال محاسبه:

**داده‌ها:**
- دوره قبل (فوریه): 100,000,000
- دوره فعلی (مارس): 400,000,000

**محاسبات:**
```
تغییر = 400M - 100M = 300M
درصد تغییر = (300M / 100M) × 100 = +300%
نوع = "رشد ناگهانی" (چون > 200%)
```

**تفسیر:**
- فروش 4 برابر شده (300% افزایش)
- نیاز به بررسی دقیق دارد
