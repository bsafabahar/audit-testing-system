# مستندات آزمون رقم اول بنفورد

## نام آزمون
**آزمون رقم اول بنفورد** (Benford's Law - First Digit Test)

## هدف و کاربرد در حسابرسی

### چرا از این آزمون استفاده می‌کنیم؟
قانون بنفورد یک اصل ریاضی است که توزیع طبیعی ارقام در مجموعه داده‌های واقعی را مشخص می‌کند. طبق این قانون، رقم اول در اعداد طبیعی به صورت تصادفی توزیع نمی‌شود، بلکه از یک الگوی مشخص پیروی می‌کند. به عنوان مثال، رقم 1 در حدود 30% موارد به عنوان رقم اول ظاهر می‌شود، در حالی که رقم 9 تنها در 4.6% موارد رقم اول است.

**در حسابرسی از این آزمون برای:**
- **کشف دستکاری در اعداد مالی:** زمانی که شخصی اعداد را جعل می‌کند، معمولاً از توزیع طبیعی بنفورد فاصله می‌گیرد
- **شناسایی تراکنش‌های مشکوک:** تراکنش‌هایی که از الگوی طبیعی پیروی نمی‌کنند
- **تایید صحت داده‌ها:** بررسی اینکه آیا داده‌های مالی طبیعی و دست‌نخورده هستند
- **تمرکز بر مناطق پرخطر:** شناسایی حساب‌ها یا دوره‌هایی که نیاز به بررسی دقیق‌تر دارند

### کاربردهای عملی:
- بررسی فاکتورهای فروش
- تحلیل هزینه‌ها و پرداخت‌ها
- کنترل اسناد حسابداری
- تشخیص تقلب در گزارش‌های مالی

## پارامترهای ورودی

### 1. نام ستون (columnName)
- **نوع:** متن (String)
- **مقدار پیش‌فرض:** 'Debit' (بدهکار)
- **توضیح:** نام ستونی که می‌خواهید آزمون روی آن اجرا شود
- **مقادیر مجاز:** 
  - `Debit`: برای تحلیل مبالغ بدهکار
  - `Credit`: برای تحلیل مبالغ بستانکار
- **مثال:** اگر می‌خواهید فاکتورهای فروش را بررسی کنید، از ستون مناسب استفاده کنید

### 2. آستانه Chi-Square (chiSquareThreshold)
- **نوع:** عدد (Number)
- **مقدار پیش‌فرض:** 15.51
- **توضیح:** حد آستانه برای تعیین میزان انحراف از توزیع بنفورد
- **مفهوم:** 
  - مقدار Chi-Square نشان‌دهنده میزان اختلاف بین توزیع واقعی و توزیع مورد انتظار بنفورد است
  - مقدار 15.51 معادل سطح اطمینان 95% برای 8 درجه آزادی است
  - اگر Chi-Square کل بیشتر از این مقدار باشد، داده‌ها از الگوی بنفورد انحراف معناداری دارند
- **راهنما:**
  - مقادیر کمتر: حساسیت بیشتر، تشخیص انحرافات جزئی
  - مقادیر بیشتر: حساسیت کمتر، تشخیص فقط انحرافات بزرگ

## ستون‌های خروجی

خروجی این آزمون یک جدول است که برای هر رقم (1 تا 9) اطلاعات زیر را نشان می‌دهد:

### 1. Digit (رقم)
- رقم اول (از 1 تا 9)
- ردیف آخر (رقم 0) خلاصه کل نتایج را نشان می‌دهد

### 2. ActualCount (تعداد واقعی)
- تعداد دفعاتی که این رقم به عنوان رقم اول در داده‌ها ظاهر شده است

### 3. ExpectedCount (تعداد مورد انتظار)
- تعداد مورد انتظار بر اساس قانون بنفورد
- محاسبه می‌شود از: کل تعداد × درصد بنفورد

### 4. ActualPercent (درصد واقعی)
- درصد واقعی ظهور این رقم در داده‌ها

### 5. ExpectedPercent (درصد مورد انتظار)
- درصد مورد انتظار بر اساس قانون بنفورد
- مثلاً برای رقم 1: 30.1%، برای رقم 9: 4.6%

### 6. Difference (تفاضل)
- اختلاف بین درصد واقعی و مورد انتظار
- مقادیر مثبت: رقم بیش از حد انتظار ظاهر شده
- مقادیر منفی: رقم کمتر از حد انتظار ظاهر شده

### 7. ChiSquareContribution (سهم Chi-Square)
- سهم این رقم در محاسبه Chi-Square کل
- هر چه بیشتر باشد، انحراف این رقم از الگوی بنفورد بیشتر است
- در ردیف آخر، مجموع Chi-Square کل نمایش داده می‌شود

## نحوه انجام آزمون

### مراحل اجرا:
1. **استخراج داده‌ها:** تمام تراکنش‌ها از پایگاه داده خوانده می‌شوند

2. **انتخاب ستون:** بر اساس پارامتر ورودی، ستون مورد نظر (بدهکار یا بستانکار) انتخاب می‌شود

3. **استخراج رقم اول:** برای هر عدد مثبت:
   - قدر مطلق عدد گرفته می‌شود
   - تا زمانی که عدد کمتر از 10 شود، بر 10 تقسیم می‌شود
   - رقم باقیمانده، رقم اول است

4. **شمارش فراوانی:** تعداد دفعات ظهور هر رقم (1 تا 9) شمارش می‌شود

5. **محاسبه آمار:**
   - برای هر رقم، درصد واقعی و مورد انتظار محاسبه می‌شود
   - اختلاف بین آنها محاسبه می‌شود
   - سهم هر رقم در Chi-Square با فرمول: `((واقعی - مورد انتظار)² / مورد انتظار)` محاسبه می‌شود

6. **محاسبه Chi-Square کل:** جمع سهم‌های Chi-Square تمام ارقام

7. **تحلیل نتیجه:** مقایسه Chi-Square کل با آستانه تعیین شده

## تفسیر نتایج

### نتایج عادی (طبیعی):
- **Chi-Square کل < 15.51:** داده‌ها از الگوی بنفورد پیروی می‌کنند
- اختلافات کوچک بین درصدهای واقعی و مورد انتظار
- داده‌ها احتمالاً طبیعی و دست‌نخورده هستند

### نتایج مشکوک:
- **Chi-Square کل > 15.51:** انحراف معنادار از قانون بنفورد
- اختلافات بزرگ در درصدها، به ویژه برای ارقام 1، 5، یا 9
- **علل احتمالی:**
  - دستکاری در اعداد
  - جعل فاکتورها
  - گرد کردن مصنوعی اعداد
  - محدودیت‌های سیستمی (مثلاً حد مجاز خرید)

### ارقام حساس:
- **رقم 1:** اگر کمتر از 30% باشد، مشکوک است
- **رقم 5 و 9:** افزایش غیرعادی این ارقام نشانه گرد کردن اعداد
- **ارقام بزرگ (7، 8، 9):** افزایش بیش از حد ممکن است نشانه دستکاری باشد

## مثال عملی

### سناریو:
شما می‌خواهید فاکتورهای خرید یک شرکت را بررسی کنید.

### تنظیمات:
- columnName: 'Debit'
- chiSquareThreshold: 15.51

### نتیجه نمونه:
```
رقم | تعداد واقعی | تعداد مورد انتظار | درصد واقعی | درصد مورد انتظار | تفاضل | سهم Chi-Square
1    | 250         | 301               | 25.0%       | 30.1%            | -5.1% | 8.6
2    | 180         | 176               | 18.0%       | 17.6%            | +0.4% | 0.1
...
9    | 80          | 46                | 8.0%        | 4.6%             | +3.4% | 25.1

کل  | 1000        | 1000              | 100%        | 100%             | 0%    | 42.3
```

### تحلیل:
- Chi-Square کل = 42.3 (بیشتر از 15.51) ➡️ **مشکوک**
- رقم 1: کمتر از انتظار (احتمال حذف فاکتورهای کوچک)
- رقم 9: بیشتر از انتظار (احتمال دستکاری برای رسیدن به حد مجاز)
- **توصیه:** بررسی دقیق فاکتورهایی که با رقم 9 شروع می‌شوند

## نکات مهم

### محدودیت‌ها:
- ❌ برای مجموعه داده‌های کوچک (کمتر از 100 رکورد) قابل اعتماد نیست
- ❌ برای اعداد تصادفی یا محدود به بازه خاص کاربرد ندارد
- ❌ برای شماره تلفن، کد پستی، یا اعداد تعیین شده دستی مناسب نیست

### بهترین کاربردها:
- ✅ فاکتورهای فروش و خرید
- ✅ مبالغ پرداختی
- ✅ رسیدهای بانکی
- ✅ هزینه‌های عملیاتی
- ✅ داده‌های مالی طبیعی با دامنه گسترده

### توصیه‌ها:
1. این آزمون را به تنهایی برای اثبات تقلب استفاده نکنید
2. نتایج مشکوک را با آزمون‌های دیگر تکمیل کنید
3. همیشه دلایل احتمالی انحراف را بررسی کنید
4. داده‌ها را به بخش‌های کوچک‌تر (مثلاً بر اساس ماه) تقسیم کنید

## ارتباط با سایر آزمون‌ها

- **آزمون دو رقم اول بنفورد:** برای دقت بیشتر
- **آزمون رقم آخر بنفورد:** برای تشخیص گرد کردن اعداد
- **آزمون تراکنش‌های تکراری:** برای تایید مشکوک بودن

## مراجع و منابع

- قانون بنفورد اولین بار توسط Frank Benford در سال 1938 مطرح شد
- استاندارد حسابرسی: این آزمون در بسیاری از استانداردهای حسابرسی مالی پذیرفته شده است
- کاربردهای قانونی: در دادگاه‌ها به عنوان شاهد تقلب مورد استفاده قرار می‌گیرد
