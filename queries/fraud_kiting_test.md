# مستندات آزمون تقلب Kiting

## نام آزمون
**آزمون شناسایی Kiting** (Check Kiting Detection Test)

## هدف و کاربرد در حسابرسی

### Check Kiting چیست؟
Kiting یک نوع تقلب بانکی است که در آن فرد با استفاده از تاخیر در تسویه چک‌ها، به طور موقت موجودی جعلی در حساب‌های بانکی ایجاد می‌کند. این کار از طریق جابجایی سریع و مکرر وجوه بین دو یا چند حساب بانکی انجام می‌شود.

**مثال ساده:**
1. شخص چک 10 میلیونی از حساب A به حساب B می‌زند
2. قبل از اینکه چک وصول شود، پول را از حساب B برداشت می‌کند
3. سپس چک دیگری از حساب B به A می‌زند
4. این چرخه به سرعت تکرار می‌شود

### چرا از این آزمون استفاده می‌کنیم؟
**در حسابرسی از این آزمون برای:**
- **کشف تقلب بانکی:** شناسایی جابجایی غیرطبیعی وجوه بین حساب‌ها
- **شناسایی مشکلات نقدینگی:** شرکت‌هایی که با مشکل نقدینگی مواجه‌اند ممکن است به kiting متوسل شوند
- **ارزیابی کنترل‌های داخلی:** ضعف در کنترل‌های بانکی
- **تشخیص الگوهای مشکوک:** انتقالات منظم و سریع بین حساب‌های مشخص

### کاربردهای عملی:
- حسابرسی حساب‌های بانکی
- بررسی گردش نقدینگی
- تحلیل تراکنش‌های بین حساب‌ها
- شناسایی مدیریت غیرقانونی جریان نقدی

## پارامترهای ورودی

### حداکثر روز بین انتقالات (maxDaysBetween)
- **نوع:** عدد صحیح (Integer)
- **مقدار پیش‌فرض:** 3
- **توضیح:** حداکثر فاصله زمانی (به روز) بین انتقالات متوالی که به عنوان مشکوک شناسایی می‌شود
- **مفهوم:**
  - در kiting معمولاً انتقالات خیلی سریع (ظرف چند روز) انجام می‌شود
  - مقدار کوچک‌تر: حساسیت بیشتر، تشخیص kiting سریع
  - مقدار بزرگ‌تر: شناسایی الگوهای کندتر
- **توصیه:**
  - برای بانک‌های سنتی: 3-5 روز
  - برای سیستم‌های آنلاین: 1-2 روز
  - برای کنترل اولیه: 7 روز

## ستون‌های خروجی

### 1. AccountPair (جفت حساب)
- نمایش جفت حساب‌هایی که بین آنها جابجایی انجام شده
- فرمت: "حساب۱ <-> حساب۲"
- به ترتیب الفبایی مرتب شده

### 2. TransferCount (تعداد انتقال)
- تعداد دفعات انتقال وجه بین این دو حساب
- هر چه بیشتر باشد، مشکوک‌تر است

### 3. TotalAmount (کل مبلغ)
- مجموع کل مبالغ منتقل شده بین دو حساب
- واحد: ریال یا واحد پول سیستم

### 4. AvgTimeBetween (میانگین زمان بین انتقالات)
- میانگین فاصله زمانی (به روز) بین انتقالات متوالی
- هر چه کمتر باشد، الگوی kiting واضح‌تر است

### 5. FirstDate (اولین تاریخ)
- تاریخ اولین انتقال بین این دو حساب

### 6. LastDate (آخرین تاریخ)
- تاریخ آخرین انتقال بین این دو حساب

### 7. SuspicionLevel (سطح مشکوک)
- **بسیار مشکوک:** میانگین زمان ≤ آستانه و تعداد انتقالات ≥ 5
- **مشکوک:** میانگین زمان ≤ آستانه و تعداد انتقالات 3-4
- **عادی:** سایر موارد (در خروجی نمایش داده نمی‌شود)

## نحوه انجام آزمون

### مراحل اجرا:

1. **دریافت داده‌ها:**
   - تمام تراکنش‌هایی که دارای فیلدهای FromAccount و ToAccount هستند خوانده می‌شوند

2. **شناسایی جفت حساب‌ها:**
   - برای هر تراکنش، جفت حساب مبدا و مقصد شناسایی می‌شود
   - جفت‌ها به صورت دو طرفه در نظر گرفته می‌شوند (A→B و B→A در یک گروه)

3. **گروه‌بندی انتقالات:**
   - تمام انتقالات بین هر جفت حساب گروه‌بندی می‌شوند
   - تاریخ و مبلغ هر انتقال ذخیره می‌شود
   - مجموع کل مبالغ محاسبه می‌شود

4. **فیلتر اولیه:**
   - فقط جفت‌هایی با حداقل 3 انتقال بررسی می‌شوند
   - (کمتر از 3 انتقال معمولاً kiting محسوب نمی‌شود)

5. **محاسبه میانگین زمان:**
   - انتقالات بر اساس تاریخ مرتب می‌شوند
   - فاصله زمانی بین هر دو انتقال متوالی محاسبه می‌شود
   - میانگین این فواصل به دست می‌آید

6. **تعیین سطح مشکوک:**
   ```
   اگر میانگین_زمان <= آستانه:
       اگر تعداد_انتقالات >= 5:
           سطح = "بسیار مشکوک"
       در غیر این صورت:
           سطح = "مشکوک"
   در غیر این صورت:
       سطح = "عادی" (حذف از خروجی)
   ```

7. **مرتب‌سازی:**
   - نتایج بر اساس میانگین زمان (کم به زیاد) مرتب می‌شوند
   - فقط موارد مشکوک و بسیار مشکوک نمایش داده می‌شوند

## تفسیر نتایج

### الگوهای Kiting:

#### کلاسیک Kiting (بسیار مشکوک):
- **ویژگی‌ها:**
  - میانگین زمان: 1-2 روز
  - تعداد انتقالات: بیش از 10
  - مبالغ قابل توجه
  - الگوی منظم و تکرارشونده

#### Kiting متوسط (مشکوک):
- **ویژگی‌ها:**
  - میانگین زمان: 3-5 روز
  - تعداد انتقالات: 5-10
  - ممکن است عمدی یا اتفاقی باشد

#### جابجایی عادی (عادی):
- **ویژگی‌ها:**
  - میانگین زمان: بیش از 7 روز
  - تعداد انتقالات: کم
  - احتمالاً مدیریت عادی نقدینگی

### علائم خطر (Red Flags):

1. **سرعت بالا:**
   - انتقالات روزانه یا هر دو روز یکبار
   - بدون توجیه تجاری منطقی

2. **مبالغ بزرگ:**
   - انتقال مبالغ قابل توجه به صورت مکرر
   - نزدیک به موجودی حساب

3. **الگوی منظم:**
   - تکرار در روزهای مشخص هفته
   - مبالغ تقریباً یکسان

4. **بدون توجیه:**
   - عدم ارتباط منطقی بین دو حساب
   - فقدان مدارک پشتیبان

## مثال عملی

### سناریو:
بررسی تراکنش‌های بانکی یک شرکت تجاری

### تنظیمات:
- maxDaysBetween: 3

### نتیجه نمونه:
```
جفت حساب         | تعداد | کل مبلغ | میانگین زمان | اولین تاریخ | آخرین تاریخ | سطح
حساب1 <-> حساب2  | 15    | 500M    | 1.2 روز      | 2024-01-01  | 2024-01-30  | بسیار مشکوک
حساب3 <-> حساب4  | 6     | 200M    | 2.5 روز      | 2024-01-05  | 2024-01-20  | مشکوک
حساب5 <-> حساب6  | 4     | 100M    | 3.0 روز      | 2024-01-10  | 2024-01-22  | مشکوک
```

### تحلیل:

**ردیف اول - بسیار مشکوک:**
- 15 انتقال در 30 روز (هر 2 روز یکبار)
- میانگین فاصله فقط 1.2 روز
- مبلغ کل بالا: 500 میلیون
- **احتمال بالای kiting** ➡️ نیاز به بررسی فوری

**اقدامات:**
1. بررسی تاریخ‌های تسویه چک‌ها
2. مقایسه با صورت‌حساب بانکی
3. بررسی موجودی واقعی حساب‌ها
4. مصاحبه با مسئول مالی

## نکات مهم

### محدودیت‌ها:
- ❌ نمی‌تواند kiting با حساب‌های خارجی را تشخیص دهد (اگر در سیستم ثبت نشده باشد)
- ❌ ممکن است مدیریت عادی نقدینگی را به اشتباه مشکوک تشخیص دهد
- ❌ نیاز به دسترسی به داده‌های کامل FromAccount و ToAccount دارد

### بهترین کاربردها:
- ✅ حسابرسی بانک‌ها و موسسات مالی
- ✅ بررسی شرکت‌های تجاری با چند حساب بانکی
- ✅ کنترل‌های داخلی خزانه‌داری
- ✅ تحقیقات تقلب

### توصیه‌های حسابرسی:

1. **تایید موجودی:**
   - دریافت تاییدیه مستقیم از بانک
   - مقایسه موجودی دفتری و بانکی
   - بررسی اقلام در حال تسویه

2. **بررسی اسناد:**
   - کپی چک‌های واقعی
   - تاریخ تسویه واقعی
   - مدارک انتقال وجه

3. **تحلیل گردش نقدی:**
   - مقایسه با فعالیت‌های تجاری
   - بررسی نیاز واقعی به نقدینگی
   - تطبیق با صورت‌های مالی

4. **مصاحبه:**
   - دلیل انتقالات مکرر
   - فرآیند تصمیم‌گیری
   - تایید اختیارات

### نشانه‌های Kiting واقعی:
- افزایش ناگهانی موجودی پایان روز
- چک‌های بزرگ بین حساب‌های خاص
- برگشت چک‌های زیاد
- موجودی منفی گذرا در حساب‌ها
- عدم توازن در گردش نقدی

## ارتباط با سایر آزمون‌ها

- **آزمون چک‌های معلق:** برای بررسی چک‌های وصول نشده
- **آزمون تطابق بانکی:** برای تایید موجودی‌ها
- **آزمون تراکنش‌های آخر هفته:** برای شناسایی تراکنش‌های مشکوک
- **آزمون Lapping:** نوع دیگری از تقلب مالی

## پیشگیری از Kiting

### کنترل‌های پیشنهادی:
1. محدودیت انتقالات بین حساب‌ها
2. تایید دو مرحله‌ای برای انتقالات بزرگ
3. بررسی روزانه موجودی‌ها
4. استفاده از سیستم‌های هشدار خودکار
5. تفکیک وظایف در بخش خزانه‌داری

### قوانین و مقررات:
- kiting در بسیاری از کشورها جرم است
- بانک‌ها موظف به گزارش فعالیت‌های مشکوک هستند
- می‌تواند منجر به پیگرد قانونی و زندان شود
